!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=i(1);var n;!function(t){const e="BlazorExtensions",i={Canvas2d:new r.ContextManager("2d"),WebGL:new r.ContextManager("webgl")};t.initialize=function(){"undefined"==typeof window||window[e]?window[e]=Object.assign({},window[e],i):window[e]=Object.assign({},i)}}(n||(n={})),n.initialize()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ContextManager=class{constructor(t){if(this.contexts=new Map,this.webGLObject=new Array,this.webGLContext=!1,this.webGLTypes=[WebGLBuffer,WebGLShader,WebGLProgram,WebGLFramebuffer,WebGLRenderbuffer,WebGLTexture,WebGLUniformLocation],this.add=((t,e)=>{if(!t)throw new Error("Invalid canvas.");if(!this.contexts.get(t.id)){var i;if(!(i=e?t.getContext(this.contextName,e):t.getContext(this.contextName)))throw new Error("Invalid context.");this.contexts.set(t.id,i)}}),this.remove=(t=>{this.contexts.delete(t.id)}),this.setProperty=((t,e,i)=>{const r=this.getContext(t);this.setPropertyWithContext(r,e,i)}),this.getProperty=((t,e)=>{const i=this.getContext(t);return this.serialize(i[e])}),this.call=((t,e,i)=>{const r=this.getContext(t);return this.callWithContext(r,e,i)}),this.pinGLEx=(t=>{this.gl=this.getContext(t)}),this.createPinEx=(t=>{const e=this.webGLObject.length;return this.webGLObject.push(this.getContext(t)),{webGLType:"WebGLPin",id:e}}),this.usePinEx=(t=>{this.gl=this.webGLObject[t]}),this.createUniformMatrixEx=(t=>{const e=this.webGLObject.length;return this.webGLObject.push(t),{webGLType:"WebGLUniformMatrix",id:e}}),this.renderUniformMatrixIEx=(t=>{const e=window.Blazor.platform.readInt32Field(t,0),i=window.Blazor.platform.readInt32Field(t,8);this.gl.uniformMatrix4fv(this.webGLObject[e],!1,this.webGLObject[i])}),this.renderUniformMatrixEx=((t,e)=>{this.gl.uniformMatrix4fv(this.webGLObject[t],!1,this.webGLObject[e])}),this.uniformMatrix4fvEx=((t,e)=>{var i=e+12,r=Module.HEAP32[i>>2],n=new Float32Array(Module.HEAPF32.buffer,i+4,r);this.gl.uniformMatrix4fv(this.webGLObject[t],!1,n)}),this.drawElementsEx=(t=>{this.gl.drawElements(this.gl.TRIANGLES,t,this.gl.UNSIGNED_SHORT,0)}),this.bindFloatBufferEx=((t,e,i)=>{this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.webGLObject[e]),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,i,this.gl.FLOAT,!1,0,0)}),this.bindUShortBufferEx=(t=>{this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.webGLObject[t])}),this.bindTextureEx=((t,e)=>{this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.webGLObject[e]),this.gl.uniform1i(this.webGLObject[t],0)}),this.blendFuncEx=(()=>{this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE)}),this.enableBlendEx=(()=>{this.gl.enable(this.gl.BLEND)}),this.disableBlendEx=(()=>{this.gl.disable(this.gl.BLEND)}),this.useProgramEx=(t=>{this.gl.useProgram(this.webGLObject[t])}),this.depthMaskOnEx=(()=>{this.gl.depthMask(!0)}),this.depthMaskOffEx=(()=>{this.gl.depthMask(!1)}),this.clearDepthAndColorEx=(()=>{this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT)}),this.clearDepthEx=(()=>{this.gl.clear(this.gl.DEPTH_BUFFER_BIT)}),this.callBatch=((t,e)=>{const i=this.getContext(t);for(let t=0;t<e.length;t++){let r=e[t].slice(2);e[t][1]?this.callWithContext(i,e[t][0],r):this.setPropertyWithContext(i,e[t][0],Array.isArray(r)&&r.length>0?r[0]:null)}}),this.callWithContext=((t,e,i)=>this.serialize(this.prototypes[e].apply(t,void 0!=i?i.map(t=>this.deserialize(e,t)):[]))),this.setPropertyWithContext=((t,e,i)=>{t[e]=this.deserialize(e,i)}),this.getContext=(t=>{if(!t)throw new Error("Invalid canvas.");const e=this.contexts.get(t.id);if(!e)throw new Error("Invalid context.");return e}),this.deserialize=((t,e)=>{if(!this.webGLContext||void 0==e)return e;if(e.hasOwnProperty("webGLType")&&e.hasOwnProperty("id"))return this.webGLObject[e.id];if(Array.isArray(e)&&!t.endsWith("v"))return Uint8Array.of(...e);if("string"!=typeof e||"bufferData"!==t&&"bufferSubData"!==t)return e;{let t=window.atob(e),r=t.length,n=new Uint8Array(r);for(var i=0;i<r;i++)n[i]=t.charCodeAt(i);return n}}),this.serialize=(t=>{if(t instanceof TextMetrics)return{width:t.width};if(!this.webGLContext||void 0==t)return t;const e=this.webGLTypes.find(e=>t instanceof e);if(void 0!=e){const i=this.webGLObject.length;return this.webGLObject.push(t),{webGLType:e.name,id:i}}return t}),this.contextName=t,"2d"===t)this.prototypes=CanvasRenderingContext2D.prototype;else{if("webgl"!==t&&"experimental-webgl"!==t)throw new Error(`Invalid context name: ${t}`);this.prototypes=WebGLRenderingContext.prototype,this.webGLContext=!0}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL0luaXRpYWxpemVDYW52YXMudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NhbnZhc0NvbnRleHRNYW5hZ2VyLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQ2FudmFzQ29udGV4dE1hbmFnZXJfMSIsIkNhbnZhcyIsImJsYXpvckV4dGVuc2lvbnMiLCJleHRlbnNpb25PYmplY3QiLCJDYW52YXMyZCIsIkNvbnRleHRNYW5hZ2VyIiwiV2ViR0wiLCJpbml0aWFsaXplIiwid2luZG93IiwiYXNzaWduIiwiW29iamVjdCBPYmplY3RdIiwiY29udGV4dE5hbWUiLCJ0aGlzIiwiY29udGV4dHMiLCJNYXAiLCJ3ZWJHTE9iamVjdCIsIkFycmF5Iiwid2ViR0xDb250ZXh0Iiwid2ViR0xUeXBlcyIsIldlYkdMQnVmZmVyIiwiV2ViR0xTaGFkZXIiLCJXZWJHTFByb2dyYW0iLCJXZWJHTEZyYW1lYnVmZmVyIiwiV2ViR0xSZW5kZXJidWZmZXIiLCJXZWJHTFRleHR1cmUiLCJXZWJHTFVuaWZvcm1Mb2NhdGlvbiIsImFkZCIsImNhbnZhcyIsInBhcmFtZXRlcnMiLCJFcnJvciIsImlkIiwiY29udGV4dCIsImdldENvbnRleHQiLCJzZXQiLCJyZW1vdmUiLCJkZWxldGUiLCJzZXRQcm9wZXJ0eSIsInNldFByb3BlcnR5V2l0aENvbnRleHQiLCJnZXRQcm9wZXJ0eSIsInNlcmlhbGl6ZSIsIm1ldGhvZCIsImFyZ3MiLCJjYWxsV2l0aENvbnRleHQiLCJwaW5HTEV4IiwiZ2wiLCJjcmVhdGVQaW5FeCIsImxlbmd0aCIsInB1c2giLCJ3ZWJHTFR5cGUiLCJ1c2VQaW5FeCIsInBpbklkIiwiY3JlYXRlVW5pZm9ybU1hdHJpeEV4IiwiZmxvYXRzIiwicmVuZGVyVW5pZm9ybU1hdHJpeElFeCIsImxvY2F0aW9uSWQiLCJCbGF6b3IiLCJwbGF0Zm9ybSIsInJlYWRJbnQzMkZpZWxkIiwibWF0cml4SWQiLCJ1bmlmb3JtTWF0cml4NGZ2IiwicmVuZGVyVW5pZm9ybU1hdHJpeEV4IiwidW5pZm9ybU1hdHJpeDRmdkV4IiwiTW9kdWxlIiwiSEVBUDMyIiwiaiIsIkZsb2F0MzJBcnJheSIsIkhFQVBGMzIiLCJidWZmZXIiLCJkcmF3RWxlbWVudHNFeCIsImNvdW50IiwiZHJhd0VsZW1lbnRzIiwiVFJJQU5HTEVTIiwiVU5TSUdORURfU0hPUlQiLCJiaW5kRmxvYXRCdWZmZXJFeCIsImF0dHJpYnV0ZSIsImJ1ZmZlcklkIiwidmFsdWVTaXplIiwiYmluZEJ1ZmZlciIsIkFSUkFZX0JVRkZFUiIsImVuYWJsZVZlcnRleEF0dHJpYkFycmF5IiwidmVydGV4QXR0cmliUG9pbnRlciIsIkZMT0FUIiwiYmluZFVTaG9ydEJ1ZmZlckV4IiwiRUxFTUVOVF9BUlJBWV9CVUZGRVIiLCJiaW5kVGV4dHVyZUV4IiwidW5pZm9ybUlkIiwidGV4dHVyZUlkIiwiYWN0aXZlVGV4dHVyZSIsIlRFWFRVUkUwIiwiYmluZFRleHR1cmUiLCJURVhUVVJFXzJEIiwidW5pZm9ybTFpIiwiYmxlbmRGdW5jRXgiLCJibGVuZEZ1bmMiLCJTUkNfQUxQSEEiLCJPTkUiLCJlbmFibGVCbGVuZEV4IiwiZW5hYmxlIiwiQkxFTkQiLCJkaXNhYmxlQmxlbmRFeCIsImRpc2FibGUiLCJ1c2VQcm9ncmFtRXgiLCJwcm9ncmFtSWQiLCJ1c2VQcm9ncmFtIiwiZGVwdGhNYXNrT25FeCIsImRlcHRoTWFzayIsImRlcHRoTWFza09mZkV4IiwiY2xlYXJEZXB0aEFuZENvbG9yRXgiLCJjbGVhciIsIkRFUFRIX0JVRkZFUl9CSVQiLCJDT0xPUl9CVUZGRVJfQklUIiwiY2xlYXJEZXB0aEV4IiwiY2FsbEJhdGNoIiwiYmF0Y2hlZENhbGxzIiwicGFyYW1zIiwic2xpY2UiLCJpc0FycmF5IiwicHJvdG90eXBlcyIsImFwcGx5IiwidW5kZWZpbmVkIiwibWFwIiwiZGVzZXJpYWxpemUiLCJlbmRzV2l0aCIsIlVpbnQ4QXJyYXkiLCJvZiIsImJpblN0ciIsImF0b2IiLCJieXRlcyIsImNoYXJDb2RlQXQiLCJUZXh0TWV0cmljcyIsIndpZHRoIiwidHlwZSIsImZpbmQiLCJDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQiLCJXZWJHTFJlbmRlcmluZ0NvbnRleHQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsYUFBd0RDLE1BQUEsV0FFeERQLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURt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RCxPQUFRZSxLQUFLRyxZQUFZckIsRUFBVyxJQUMvQixHQUFJc0IsTUFBTW9HLFFBQVExSCxLQUFZOEMsRUFBT2tGLFNBQVMsS0FDbkQsT0FBT0MsV0FBV0MsTUFBT2xJLEdBQ3BCLEdBQXVCLGlCQUFiLEdBQXFDLGVBQVg4QyxHQUFzQyxrQkFBWEEsRUFTcEUsT0FBTzlDLEVBVDBGLENBQ2pHLElBQUltSSxFQUFTckgsT0FBT3NILEtBQUtwSSxHQUNyQm9ELEVBQVMrRSxFQUFPL0UsT0FDaEJpRixFQUFRLElBQUlKLFdBQVc3RSxHQUMzQixJQUFLLElBQUk5RSxFQUFJLEVBQUdBLEVBQUk4RSxFQUFROUUsSUFDeEIrSixFQUFNL0osR0FBSzZKLEVBQU9HLFdBQVdoSyxHQUVqQyxPQUFPK0osS0FLSG5ILEtBQUEyQixVQUFZLENBQUM3QyxJQUNuQixHQUFJQSxhQUFrQnVJLFlBQ2xCLE9BQVNDLE1BQU94SSxFQUFPd0ksT0FHM0IsSUFBS3RILEtBQUtLLG1CQUEwQnNHLEdBQVY3SCxFQUFxQixPQUFPQSxFQUV0RCxNQUFNeUksRUFBT3ZILEtBQUtNLFdBQVdrSCxLQUFNRCxHQUFTekksYUFBa0J5SSxHQUM5RCxRQUFZWixHQUFSWSxFQUFtQixDQUNyQixNQUFNckcsRUFBS2xCLEtBQUtHLFlBQVkrQixPQUc1QixPQUZBbEMsS0FBS0csWUFBWWdDLEtBQUtyRCxJQUdwQnNELFVBQVdtRixFQUFLNUosS0FDaEJ1RCxHQUFJQSxHQUdOLE9BQU9wQyxJQTVNVGtCLEtBQUtELFlBQWNBLEVBQ0MsT0FBaEJBLEVBQ0ZDLEtBQUt5RyxXQUFhZ0IseUJBQXlCekksY0FDeEMsSUFBb0IsVUFBaEJlLEdBQTJDLHVCQUFoQkEsRUFJbEMsTUFBTSxJQUFJa0IsK0JBQStCbEIsS0FIekNDLEtBQUt5RyxXQUFhaUIsc0JBQXNCMUksVUFDeENnQixLQUFLSyxjQUFlIiwiZmlsZSI6ImJsYXpvci5leHRlbnNpb25zLmNhbnZhcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IENvbnRleHRNYW5hZ2VyIH0gZnJvbSAnLi9DYW52YXNDb250ZXh0TWFuYWdlcic7XHJcblxyXG5uYW1lc3BhY2UgQ2FudmFzIHtcclxuICBjb25zdCBibGF6b3JFeHRlbnNpb25zOiBzdHJpbmcgPSAnQmxhem9yRXh0ZW5zaW9ucyc7XHJcbiAgLy8gZGVmaW5lIHdoYXQgdGhpcyBleHRlbnNpb24gYWRkcyB0byB0aGUgd2luZG93IG9iamVjdCBpbnNpZGUgQmxhem9yRXh0ZW5zaW9uc1xyXG4gIGNvbnN0IGV4dGVuc2lvbk9iamVjdCA9IHtcclxuICAgIENhbnZhczJkOiBuZXcgQ29udGV4dE1hbmFnZXIoXCIyZFwiKSxcclxuICAgIFdlYkdMOiBuZXcgQ29udGV4dE1hbmFnZXIoXCJ3ZWJnbFwiKVxyXG4gIH07XHJcblxyXG4gIGV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplKCk6IHZvaWQge1xyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmICF3aW5kb3dbYmxhem9yRXh0ZW5zaW9uc10pIHtcclxuICAgICAgLy8gd2hlbiB0aGUgbGlicmFyeSBpcyBsb2FkZWQgaW4gYSBicm93c2VyIHZpYSBhIDxzY3JpcHQ+IGVsZW1lbnQsIG1ha2UgdGhlXHJcbiAgICAgIC8vIGZvbGxvd2luZyBBUElzIGF2YWlsYWJsZSBpbiBnbG9iYWwgc2NvcGUgZm9yIGludm9jYXRpb24gZnJvbSBKU1xyXG4gICAgICB3aW5kb3dbYmxhem9yRXh0ZW5zaW9uc10gPSB7XHJcbiAgICAgICAgLi4uZXh0ZW5zaW9uT2JqZWN0XHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB3aW5kb3dbYmxhem9yRXh0ZW5zaW9uc10gPSB7XHJcbiAgICAgICAgLi4ud2luZG93W2JsYXpvckV4dGVuc2lvbnNdLFxyXG4gICAgICAgIC4uLmV4dGVuc2lvbk9iamVjdFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuQ2FudmFzLmluaXRpYWxpemUoKTtcclxuIiwiZGVjbGFyZSBnbG9iYWwge1xyXG4gICAgaW50ZXJmYWNlIFdpbmRvdyB7XHJcbiAgICAgICAgQmxhem9yOiBhbnk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIGRlY2xhcmUgY29uc3Qgd2luZG93OiBhbnk7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29udGV4dE1hbmFnZXIge1xyXG4gICAgcHJpdmF0ZSBnbDogYW55O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGV4dHMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgd2ViR0xPYmplY3QgPSBuZXcgQXJyYXk8YW55PigpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGV4dE5hbWU6IHN0cmluZztcclxuICBwcml2YXRlIHdlYkdMQ29udGV4dCA9IGZhbHNlO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgcHJvdG90eXBlczogYW55O1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgd2ViR0xUeXBlcyA9IFtcclxuICAgIFdlYkdMQnVmZmVyLCBXZWJHTFNoYWRlciwgV2ViR0xQcm9ncmFtLCBXZWJHTEZyYW1lYnVmZmVyLCBXZWJHTFJlbmRlcmJ1ZmZlciwgV2ViR0xUZXh0dXJlLCBXZWJHTFVuaWZvcm1Mb2NhdGlvblxyXG4gIF07XHJcblxyXG4gIHB1YmxpYyBjb25zdHJ1Y3Rvcihjb250ZXh0TmFtZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmNvbnRleHROYW1lID0gY29udGV4dE5hbWU7XHJcbiAgICBpZiAoY29udGV4dE5hbWUgPT09IFwiMmRcIilcclxuICAgICAgdGhpcy5wcm90b3R5cGVzID0gQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELnByb3RvdHlwZTtcclxuICAgIGVsc2UgaWYgKGNvbnRleHROYW1lID09PSBcIndlYmdsXCIgfHwgY29udGV4dE5hbWUgPT09IFwiZXhwZXJpbWVudGFsLXdlYmdsXCIpIHtcclxuICAgICAgdGhpcy5wcm90b3R5cGVzID0gV2ViR0xSZW5kZXJpbmdDb250ZXh0LnByb3RvdHlwZTtcclxuICAgICAgdGhpcy53ZWJHTENvbnRleHQgPSB0cnVlO1xyXG4gICAgfSBlbHNlXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBjb250ZXh0IG5hbWU6ICR7Y29udGV4dE5hbWV9YCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYWRkID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIHBhcmFtZXRlcnM6IGFueSkgPT4ge1xyXG4gICAgaWYgKCFjYW52YXMpIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjYW52YXMuJyk7XHJcbiAgICBpZiAodGhpcy5jb250ZXh0cy5nZXQoY2FudmFzLmlkKSkgcmV0dXJuO1xyXG5cclxuICAgIHZhciBjb250ZXh0O1xyXG4gICAgaWYgKHBhcmFtZXRlcnMpXHJcbiAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCh0aGlzLmNvbnRleHROYW1lLCBwYXJhbWV0ZXJzKTtcclxuICAgIGVsc2VcclxuICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KHRoaXMuY29udGV4dE5hbWUpO1xyXG5cclxuICAgIGlmICghY29udGV4dCkgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbnRleHQuJyk7XHJcblxyXG4gICAgdGhpcy5jb250ZXh0cy5zZXQoY2FudmFzLmlkLCBjb250ZXh0KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZW1vdmUgPSAoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkgPT4ge1xyXG4gICAgdGhpcy5jb250ZXh0cy5kZWxldGUoY2FudmFzLmlkKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRQcm9wZXJ0eSA9IChjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCBwcm9wZXJ0eTogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XHJcbiAgICB0aGlzLnNldFByb3BlcnR5V2l0aENvbnRleHQoY29udGV4dCwgcHJvcGVydHksIHZhbHVlKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRQcm9wZXJ0eSA9IChjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCBwcm9wZXJ0eTogc3RyaW5nKSA9PiB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XHJcbiAgICByZXR1cm4gdGhpcy5zZXJpYWxpemUoY29udGV4dFtwcm9wZXJ0eV0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNhbGwgPSAoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgbWV0aG9kOiBzdHJpbmcsIGFyZ3M6IGFueSkgPT4ge1xyXG4gICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XHJcbiAgICAgIHJldHVybiB0aGlzLmNhbGxXaXRoQ29udGV4dChjb250ZXh0LCBtZXRob2QsIGFyZ3MpO1xyXG4gIH1cclxuXHJcblxyXG4gIHB1YmxpYyBwaW5HTEV4ID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5nbCA9IHRoaXMuZ2V0Q29udGV4dChjYW52YXMpO1xyXG4gIH1cclxuXHJcbiAgICBwdWJsaWMgY3JlYXRlUGluRXggPSAoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy53ZWJHTE9iamVjdC5sZW5ndGg7XHJcbiAgICAgICAgdGhpcy53ZWJHTE9iamVjdC5wdXNoKHRoaXMuZ2V0Q29udGV4dChjYW52YXMpKTtcclxuICAgICAgICByZXR1cm4geyB3ZWJHTFR5cGU6ICdXZWJHTFBpbicsIGlkOiBpZCB9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1c2VQaW5FeCA9IChwaW5JZDogYW55KSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbCA9IHRoaXMud2ViR0xPYmplY3RbcGluSWRdO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcmVhdGVVbmlmb3JtTWF0cml4RXggPSAoZmxvYXRzOiBhbnkpID0+IHtcclxuICAgICAgICBjb25zdCBpZCA9IHRoaXMud2ViR0xPYmplY3QubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMud2ViR0xPYmplY3QucHVzaChmbG9hdHMpO1xyXG4gICAgICAgIHJldHVybiB7IHdlYkdMVHlwZTogJ1dlYkdMVW5pZm9ybU1hdHJpeCcsIGlkOiBpZCB9O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXJVbmlmb3JtTWF0cml4SUV4ID0gKGFyZ3M6IGFueSkgPT4ge1xyXG4gICAgICBjb25zdCBsb2NhdGlvbklkID0gd2luZG93LkJsYXpvci5wbGF0Zm9ybS5yZWFkSW50MzJGaWVsZChhcmdzLCAwKTtcclxuICAgICAgY29uc3QgbWF0cml4SWQgPSB3aW5kb3cuQmxhem9yLnBsYXRmb3JtLnJlYWRJbnQzMkZpZWxkKGFyZ3MsIDgpO1xyXG4gICAgICB0aGlzLmdsLnVuaWZvcm1NYXRyaXg0ZnYodGhpcy53ZWJHTE9iamVjdFtsb2NhdGlvbklkXSwgZmFsc2UsIHRoaXMud2ViR0xPYmplY3RbbWF0cml4SWRdKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVuZGVyVW5pZm9ybU1hdHJpeEV4ID0gKGxvY2F0aW9uSWQ6IGFueSwgbWF0cml4SWQ6IGFueSkgPT4ge1xyXG4gICAgICB0aGlzLmdsLnVuaWZvcm1NYXRyaXg0ZnYodGhpcy53ZWJHTE9iamVjdFtsb2NhdGlvbklkXSwgZmFsc2UsIHRoaXMud2ViR0xPYmplY3RbbWF0cml4SWRdKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjb252ZXJzaW9uIHRvIGpzIGZsb2F0IDMyIGFycmF5IGZyb206XHJcbiAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82MzkwMjQ5Ny9ibGF6b3Itd2FzbS1pbnZva2UtamF2YXNjcmlwdC1wYXNzLWxhcmdlLWFycmF5LWlzLXZlcnktc2xvd1xyXG4gICAgLy9cclxuICAgIHB1YmxpYyB1bmlmb3JtTWF0cml4NGZ2RXggPSAobG9jYXRpb25JZDogYW55LCBmbG9hdHM6IGFueSkgPT4ge1xyXG4gICAgICAgIHZhciBtID0gZmxvYXRzICsgMTI7XHJcbiAgICAgICAgdmFyIHIgPSBNb2R1bGUuSEVBUDMyW20gPj4gMl07XHJcbiAgICAgICAgdmFyIGogPSBuZXcgRmxvYXQzMkFycmF5KE1vZHVsZS5IRUFQRjMyLmJ1ZmZlciwgbSArIDQsIHIpO1xyXG4gICAgICAgIHRoaXMuZ2wudW5pZm9ybU1hdHJpeDRmdih0aGlzLndlYkdMT2JqZWN0W2xvY2F0aW9uSWRdLCBmYWxzZSwgaik7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRyYXdFbGVtZW50c0V4ID0gKGNvdW50OiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmRyYXdFbGVtZW50cyh0aGlzLmdsLlRSSUFOR0xFUywgY291bnQsIHRoaXMuZ2wuVU5TSUdORURfU0hPUlQsIDApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBiaW5kRmxvYXRCdWZmZXJFeCA9IChhdHRyaWJ1dGU6IGFueSwgYnVmZmVySWQ6IGFueSwgdmFsdWVTaXplOiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmJpbmRCdWZmZXIodGhpcy5nbC5BUlJBWV9CVUZGRVIsIHRoaXMud2ViR0xPYmplY3RbYnVmZmVySWRdKTtcclxuICAgICAgICB0aGlzLmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGF0dHJpYnV0ZSk7XHJcbiAgICAgICAgdGhpcy5nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKGF0dHJpYnV0ZSwgdmFsdWVTaXplLCB0aGlzLmdsLkZMT0FULCBmYWxzZSwgMCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGJpbmRVU2hvcnRCdWZmZXJFeCA9IChidWZmZXJJZDogYW55KSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbC5iaW5kQnVmZmVyKHRoaXMuZ2wuRUxFTUVOVF9BUlJBWV9CVUZGRVIsIHRoaXMud2ViR0xPYmplY3RbYnVmZmVySWRdKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYmluZFRleHR1cmVFeCA9ICh1bmlmb3JtSWQ6IGFueSwgdGV4dHVyZUlkOiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmFjdGl2ZVRleHR1cmUodGhpcy5nbC5URVhUVVJFMCk7XHJcbiAgICAgICAgdGhpcy5nbC5iaW5kVGV4dHVyZSh0aGlzLmdsLlRFWFRVUkVfMkQsIHRoaXMud2ViR0xPYmplY3RbdGV4dHVyZUlkXSk7XHJcbiAgICAgICAgdGhpcy5nbC51bmlmb3JtMWkodGhpcy53ZWJHTE9iamVjdFt1bmlmb3JtSWRdLCAwKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYmxlbmRGdW5jRXggPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbC5ibGVuZEZ1bmModGhpcy5nbC5TUkNfQUxQSEEsIHRoaXMuZ2wuT05FKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZW5hYmxlQmxlbmRFeCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmVuYWJsZSh0aGlzLmdsLkJMRU5EKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGlzYWJsZUJsZW5kRXggPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbC5kaXNhYmxlKHRoaXMuZ2wuQkxFTkQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1c2VQcm9ncmFtRXggPSAocHJvZ3JhbUlkOiBhbnkpID0+IHtcclxuICAgICAgICB0aGlzLmdsLnVzZVByb2dyYW0odGhpcy53ZWJHTE9iamVjdFtwcm9ncmFtSWRdKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVwdGhNYXNrT25FeCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmRlcHRoTWFzayh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVwdGhNYXNrT2ZmRXggPSAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5nbC5kZXB0aE1hc2soZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGVhckRlcHRoQW5kQ29sb3JFeCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmdsLmNsZWFyKHRoaXMuZ2wuREVQVEhfQlVGRkVSX0JJVCB8IHRoaXMuZ2wuQ09MT1JfQlVGRkVSX0JJVCk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgY2xlYXJEZXB0aEV4ID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZ2wuY2xlYXIodGhpcy5nbC5ERVBUSF9CVUZGRVJfQklUKTtcclxuICAgIH1cclxuICAgIFxyXG4gIHB1YmxpYyBjYWxsQmF0Y2ggPSAoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgYmF0Y2hlZENhbGxzOiBhbnlbXVtdKSA9PiB7XHJcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5nZXRDb250ZXh0KGNhbnZhcyk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJhdGNoZWRDYWxscy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBsZXQgcGFyYW1zID0gYmF0Y2hlZENhbGxzW2ldLnNsaWNlKDIpO1xyXG4gICAgICBpZiAoYmF0Y2hlZENhbGxzW2ldWzFdKSB7XHJcbiAgICAgICAgdGhpcy5jYWxsV2l0aENvbnRleHQoY29udGV4dCwgYmF0Y2hlZENhbGxzW2ldWzBdLCBwYXJhbXMpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHlXaXRoQ29udGV4dChcclxuICAgICAgICAgIGNvbnRleHQsXHJcbiAgICAgICAgICBiYXRjaGVkQ2FsbHNbaV1bMF0sXHJcbiAgICAgICAgICBBcnJheS5pc0FycmF5KHBhcmFtcykgJiYgcGFyYW1zLmxlbmd0aCA+IDAgPyBwYXJhbXNbMF0gOiBudWxsKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxsV2l0aENvbnRleHQgPSAoY29udGV4dDogYW55LCBtZXRob2Q6IHN0cmluZywgYXJnczogYW55KSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5zZXJpYWxpemUodGhpcy5wcm90b3R5cGVzW21ldGhvZF0uYXBwbHkoY29udGV4dCwgYXJncyAhPSB1bmRlZmluZWQgPyBhcmdzLm1hcCgodmFsdWUpID0+IHRoaXMuZGVzZXJpYWxpemUobWV0aG9kLCB2YWx1ZSkpIDogW10pKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2V0UHJvcGVydHlXaXRoQ29udGV4dCA9IChjb250ZXh0OiBhbnksIHByb3BlcnR5OiBzdHJpbmcsIHZhbHVlOiBhbnkpID0+IHtcclxuICAgIGNvbnRleHRbcHJvcGVydHldID0gdGhpcy5kZXNlcmlhbGl6ZShwcm9wZXJ0eSwgdmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRDb250ZXh0ID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpID0+IHtcclxuICAgIGlmICghY2FudmFzKSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY2FudmFzLicpO1xyXG5cclxuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLmNvbnRleHRzLmdldChjYW52YXMuaWQpO1xyXG4gICAgaWYgKCFjb250ZXh0KSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29udGV4dC4nKTtcclxuXHJcbiAgICByZXR1cm4gY29udGV4dDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGVzZXJpYWxpemUgPSAobWV0aG9kOiBzdHJpbmcsIG9iamVjdDogYW55KSA9PiB7XHJcbiAgICBpZiAoIXRoaXMud2ViR0xDb250ZXh0IHx8IG9iamVjdCA9PSB1bmRlZmluZWQpIHJldHVybiBvYmplY3Q7IC8vZGVzZXJpYWxpemF0aW9uIG9ubHkgbmVlZHMgdG8gaGFwcGVuIGZvciB3ZWJHTFxyXG5cclxuICAgIGlmIChvYmplY3QuaGFzT3duUHJvcGVydHkoXCJ3ZWJHTFR5cGVcIikgJiYgb2JqZWN0Lmhhc093blByb3BlcnR5KFwiaWRcIikpIHtcclxuICAgICAgcmV0dXJuICh0aGlzLndlYkdMT2JqZWN0W29iamVjdFtcImlkXCJdXSk7XHJcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkob2JqZWN0KSAmJiAhbWV0aG9kLmVuZHNXaXRoKFwidlwiKSkge1xyXG4gICAgICByZXR1cm4gVWludDhBcnJheS5vZiguLi4ob2JqZWN0IGFzIG51bWJlcltdKSk7XHJcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihvYmplY3QpID09PSBcInN0cmluZ1wiICYmIChtZXRob2QgPT09IFwiYnVmZmVyRGF0YVwiIHx8IG1ldGhvZCA9PT0gXCJidWZmZXJTdWJEYXRhXCIpKSB7XHJcbiAgICAgIGxldCBiaW5TdHIgPSB3aW5kb3cuYXRvYihvYmplY3QpO1xyXG4gICAgICBsZXQgbGVuZ3RoID0gYmluU3RyLmxlbmd0aDtcclxuICAgICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkobGVuZ3RoKTtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgYnl0ZXNbaV0gPSBiaW5TdHIuY2hhckNvZGVBdChpKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYnl0ZXM7XHJcbiAgICB9IGVsc2VcclxuICAgICAgcmV0dXJuIG9iamVjdDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2VyaWFsaXplID0gKG9iamVjdDogYW55KSA9PiB7XHJcbiAgICBpZiAob2JqZWN0IGluc3RhbmNlb2YgVGV4dE1ldHJpY3MpIHtcclxuICAgICAgICByZXR1cm4geyB3aWR0aDogb2JqZWN0LndpZHRoIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF0aGlzLndlYkdMQ29udGV4dCB8fCBvYmplY3QgPT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqZWN0OyAvL3NlcmlhbGl6YXRpb24gb25seSBuZWVkcyB0byBoYXBwZW4gZm9yIHdlYkdMXHJcblxyXG4gICAgY29uc3QgdHlwZSA9IHRoaXMud2ViR0xUeXBlcy5maW5kKCh0eXBlKSA9PiBvYmplY3QgaW5zdGFuY2VvZiB0eXBlKTtcclxuICAgIGlmICh0eXBlICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICBjb25zdCBpZCA9IHRoaXMud2ViR0xPYmplY3QubGVuZ3RoO1xyXG4gICAgICB0aGlzLndlYkdMT2JqZWN0LnB1c2gob2JqZWN0KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgd2ViR0xUeXBlOiB0eXBlLm5hbWUsXHJcbiAgICAgICAgaWQ6IGlkXHJcbiAgICAgICAgfTtcclxuICAgIH0gZWxzZVxyXG4gICAgICByZXR1cm4gb2JqZWN0O1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9